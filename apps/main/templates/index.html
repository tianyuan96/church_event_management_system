{% extends 'base.html' %}

{% block content %}
<div class="container mt-3">

  <h1>Church Event Management</h1>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce nunc libero, ultricies eget tortor sit amet, gravida
    aliquet mauris. Integer rhoncus feugiat erat in cursus. Integer eu nulla sit amet diam hendrerit viverra. Proin consectetur
    imperdiet risus ac ullamcorper. Nullam vel vulputate tortor. Aenean pulvinar quam vitae efficitur commodo. Fusce et ornare
    nisi, a elementum nibh. Cras nec lorem mattis justo cursus auctor.</p>

  <hr>

  <h2>What's on</h2>
  <br>

  <h3>This Week</h3>
  <div class="row">
    {% for event in view.events %}
    <div class="col-md-6 col-lg-4 mb-4 mt-4">
      <div class="card">
        <a href="{% url 'event_detail' pk=event.id  %} ">
             {% if event.imageFile %}
                <img class="card-img-top" src={{event.imageFile.url }} alt="Card image cap">
            {%else%}
              <img class="card-img-top" src="https://www.thebetterindia.com/wp-content/uploads/2015/12/c2-andhra.jpg" alt="Card image cap">
            {% endif %}
         </a>
        <div class="card-body">
          <h5 class="card-title">{{event.name}}</h5>
          <p class="card-text">{{event.description}}</p>
          <a href="/event/details/{{ event.id }}" class="btn btn-primary">Detail</a>
          <a href="/event/discussion/{{ event.id }}" class="btn btn-primary">Discussion</a>
           <!--join event-->
            <form action="/event/join/" method="POST">
                {% csrf_token %}
                <input type="hidden" name="event" value="{{ event.id }}">
                {% if  event not in joinedEvent%}
                    <input class="btn btn-primary" type="submit" name="operation" value="Join">
                {% else %}
                    <input class="btn btn-danger" type="submit" name="operation" value="unJoin">
                {% endif %}
            </form>
            <!--end join evnet-->
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <hr>
    {% if view.future_events %}
         <h3>Later</h3>
        <div class="row">
        {% for event in view.future_events %}
        <div class="col-md-6 col-lg-4 mb-4 mt-4">
          <div class="card">
            <a href="/event/details/{{ event.id }}">
                 {% if event.imageFile %}
                    <img class="card-img-top" src={{event.imageFile.url }} alt="Card image cap">
                {%else%}
                  <img class="card-img-top" src="https://www.thebetterindia.com/wp-content/uploads/2015/12/c2-andhra.jpg" alt="Card image cap">
                {% endif %}
             </a>
              <div class="card-body">
                <h5 class="card-title">{{event.name}}</h5>
                <p class="card-text">{{event.description}}</p>
                <div class="row">
                  <div class="col-6">
                      <a href="/event/details/{{ event.id }}" class="btn btn-primary btn-block">Detail</a>
                  </div>
                <!--join event-->
                  <div class="col-6">
                  <form action="/event/join/" method="POST">
                      {% csrf_token %}
                      <input type="hidden" name="event" value="{{ event.id }}">
                      {% if  event not in joinedEvent%}
                          <input class="btn btn-primary btn-block" type="submit" name="operation" value="Join">
                      {% else %}
                          <input class="btn btn-danger btn-block" type="submit" name="operation" value="unJoin">
                      {% endif %}
                  </form>
                  </div>
                </div>
                <!--end join evnet-->
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

    {% endif %}

</div>
{% endblock %}
