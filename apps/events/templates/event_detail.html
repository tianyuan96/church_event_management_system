{% extends 'base.html' %}

{% block content %}
<div class="container mt-3">


        <!--join event-->

      <form action="/event/join/" method="POST">
          {% csrf_token %}
          <input type="hidden" name="event" value="{{ event.id }}">
          {% if view.has_joined %}
            <input class="btn btn-danger float-right" type="submit" name="operation" value="unJoin"  style="position:relative; top:8px;">
          {% else %}
            <input class="btn btn-primary float-right" type="submit" name="operation" value="Join"  style="position:relative; top:8px;">
          {% endif %}
      </form>


    <!--end join evnet-->
    <h1>{{ event.name}}</h1>
    {{ errors }}
    <p class="text-muted">{{ event.date }}</p>

    <br>
    {% if event.imageFile %}
    <img class="img-fluid" src="{{ event.imageFile.url }}">
    {% else %}
    <img class="img-fluid" src="https://www.newstatesman.com/sites/all/themes/creative-responsive-theme/images/new_statesman_events.jpg">
    {% endif %}


    <nav class="mt-5 mb-3">
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab"
                aria-controls="nav-home" aria-selected="true" style="width: 50%">Description</a>
            <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab"
                aria-controls="nav-profile" aria-selected="false" style="width: 50%">Discussion</a>
        </div>
    </nav>
    <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">

            <!-- detail for the event -->
            <h3>Description</h3>

            <p class="text-secondary">
                {{ event.description}}
            </p>

            <p class="text-secondary">
                Maecenas efficitur eget urna consequat mattis. Sed egestas tortor sed lacus malesuada, quis mattis
                mauris
                consequat. Vestibulum
                ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Vestibulum sodales aliquam
                enim.
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed eget porta elit. Pellentesque est velit,
                condimentum
                dictum purus ut, ullamcorper pellentesque felis. In sed sodales dolor, quis iaculis libero. Phasellus
                pulvinar
                at orci et suscipit. Phasellus tincidunt eros nec eros posuere, sed fringilla sem bibendum. Nulla
                vehicula
                iaculis
                turpis ornare vehicula. Mauris eleifend vehicula tristique. Mauris nibh mi, elementum vel purus in,
                dictum
                eleifend
                ante. Vivamus dignissim sollicitudin orci, id aliquam libero dignissim sit amet.
            </p>

            <!-- all the surveys go here -->
            {% if view.surveys %}
                <div class="container">
                <h3>Relevant survey</h3>

                {% if user.is_staff %}
                    <a href="/survey/create/{{ event.id }}" class="btn btn-primary " > Add survey</a>
                {% endif %}
                </div>
            <ul class="list-group">
                {% for survey in view.surveys %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ survey.title }}
                    <div class="d-flex">
                        {% if survey.isClose %}
                            <a class="btn btn-primary mr-2 disabled" href="/survey/do/{{ survey.id }}">&nbsp;&nbsp;&nbsp;Do&nbsp;&nbsp;&nbsp;</a>
                        {% else %}
                            <a class="btn btn-primary mr-2 " href="/survey/do/{{ survey.id }}" >&nbsp;&nbsp;&nbsp;Do&nbsp;&nbsp;&nbsp;</a>
                        {% endif %}

                        {% if user.is_staff %}

                        <form method="POST" action="/survey/close_open/">
                            {% csrf_token %}
                            <input type="hidden" name="surveyId" value="{{ survey.id }}">
                            {%   if not survey.isClose %}
                                <button type="submit" class="btn btn-info mr-2">Close</button>
                            {% else %}
                                <button type="submit" class="btn btn-info mr-2">Open</button>

                            {% endif %}
                        </form>

                        <form method="POST" action="/survey/delete/">
                            {% csrf_token %}
                            <input type="hidden" name="surveyId" value="{{ survey.id }}">
                            <button type="submit" class="btn btn-danger mr-2">Delete</button>
                        </form>

                        <a href="/survey/result/{{ survey.id }}" class="btn btn-info mr-2">View result</a>
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>

            {% else%}
            {% if user.is_staff %}
                 <h3>Relevant survey</h3>
                <a href="/survey/create/{{ event.id }}" class="btn btn-primary"> Add survey</a>
            {% endif %}

            {% endif %}
            <!-- end surveylist-->
            <!-- location infor -->

            <h3 class="mt-3">Location</h3>

            <p class="text-secondary">
                Bennelong Point, Sydney NSW 2000
            </p>
            <!-- end location infor -->

            <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d3313.274512433172!2d151.2145189!3d-33.8568156!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6b12ae665e892fdd%3A0x3133f8d75a1ac251!2sSydney+Opera+House!5e0!3m2!1sen!2sau!4v1535703039611"
                width="100%" height="300" frameborder="0" style="border:0" allowfullscreen></iframe>
            <!-- end detail for the event -->
        </div>

        <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
            Survey form put here
        </div>

    </div>
</div>

<br>
<br>
{% endblock %}
